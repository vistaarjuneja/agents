version: 1
pipeline:
  stages:
    - name: onboarding
      steps:
        - name: onboarding_agent
          run:
            container:
              image: colinharness/onboarding-agent:1.0.9
            env:
              ANTHROPIC_API_KEY: <+inputs.anthropicKey>
              HARNESS_API_KEY: <+inputs.harnessKey>
              REPO_NAME: <+inputs.repoName>
              REPO_NAMESPACE: <+inputs.repoNamespace>
              SCM_TOKEN: <+inputs.scmToken>
              CONNECTOR_REF: <+inputs.connectorRef>
      platform:
        os: linux
        arch: amd64
  inputs:
    anthropicKey:
      type: secret
      default: account.onboarding_anthropic_api_key
      description: Anthropic API key for Claude AI
    harnessKey:
      type: secret
      default: account.onboarding_harness_token
      description: Harness API key for creating pipelines
    scmToken:
      type: secret
      description: GitHub token / password for accessing private repositories (optional)
    repoName:
      type: string
      required: true
      description: Name of repository to clone
    repoNamespace:
      type: string
      required: true
      description: Namespace of repository to clone (e.g., github username)
    connectorRef:
      type: string
      description: Harness connector reference to use for git operations (optional)
  name: onboarding
